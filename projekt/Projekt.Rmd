---
title: "Projekt Baseball - Oscar Teeninga i Tomasz Markiewicz"
output: html_document
---

```{r setup, include=FALSE}
library(ISLR)
library(class)
library(MASS)
knitr::opts_chunk$set(message = FALSE)
```

## Zbiór danych

```{r dane}
print("Zbiór danych z 322 obserwacjami dotyczących główych graczy ligowych baseballu z roku 1986 i 1987. Liczba zmiennych: 20")
print(Hitters)
```
## Podział zbioru na treningowy i testowy
```{r split dataset}
set.seed(123)
sample <- sample.int(n = nrow(Hitters), size = floor(.8*nrow(Hitters)), replace = F)
train <- Hitters[sample, ]
test  <- Hitters[-sample, ]
```

## League
```{r league-glm}
legue_glm <- list()
legue_glm$fit <- glm(League ~ AtBat + Hits + HmRun + Runs + RBI + Walks + Years + CAtBat + CHits + CHmRun + CRuns + CRBI + CWalks + Division + PutOuts + Assists + Errors + Salary + NewLeague, family = binomial, data = train)
legue_glm$probs <- predict(legue_glm$fit, test, type = "response")
legue_glm$predicted <- ifelse(legue_glm$probs > 0.5, "N", "A")
table(legue_glm$predicted, test$League)
```
```{r league-lda}
legue_lda <- list()
legue_lda$fit <- lda(League ~ AtBat + Hits + HmRun + Runs + RBI + Walks + Years + CAtBat + CHits + CHmRun + CRuns + CRBI + CWalks + Division + PutOuts + Assists + Errors + Salary + NewLeague, family = binomial, data = train)
legue_lda$predicted <- predict(legue_lda$fit, test)
table(legue_lda$predicted$class, test$League)
```
```{r league-qda}
legue_qda <- list()
legue_qda$fit <- qda(League ~ AtBat + Hits + HmRun + Runs + RBI + Walks + Years + CAtBat + CHits + CHmRun + CRuns + CRBI + CWalks + Division + PutOuts + Assists + Errors + Salary + NewLeague, family = binomial, data = train)
legue_qda$predicted <- predict(legue_qda$fit, test)
table(legue_qda$predicted$class, test$League)
```